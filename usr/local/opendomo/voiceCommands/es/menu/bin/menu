#!/bin/bash
read ESPEAK < /etc/opendomo/speech/espeak.dat
if [ "$1" = "0" ]
then
	# This option, restarts MENU, to the first level	
	/usr/local/opendomo/vr/espeak.sh Menu0
	echo "menu0" > /usr/local/opendomo/vr/MENU
elif [ "$1" = "11" ]
then
	#11 ==> Salir del modo menú
	/usr/local/opendomo/vr/espeak.sh Menusalir
	echo "no" > /usr/local/opendomo/vr/MENU
else
	read menu < /usr/local/opendomo/vr/MENU
	case "$menu" in
	no)
		/usr/local/opendomo/vr/espeak.sh MenuNo
		;;	
	menu0)
		case "$1" in
			1)
			/usr/local/opendomo/vr/espeak.sh Menu1e
			echo "menu1" > /usr/local/opendomo/vr/MENU 
			;;
			2)
			/usr/local/opendomo/vr/espeak.sh Menu2e
			echo "menu2" > /usr/local/opendomo/vr/MENU
			;; 
			3)
			/usr/local/opendomo/vr/espeak.sh Menu3e
			echo "menu3" > /usr/local/opendomo/vr/MENU
			;;
			10)
			#10 ==> Volver. En este caso, como estamos en el Menu principal (Menu0) repetimos el mismo Menu0
			/usr/local/opendomo/vr/espeak.sh Menu0
			echo "menu0" > /usr/local/opendomo/vr/MENU
			;;
			else)
			#Opción no válida. Repetir opciones de menu, y quedarse en el mismo estado
			/usr/local/opendomo/vr/espeak.sh Menunoval Menu0
			;;   
		esac
		;;
	menu1)
		case "$1" in
			1)
			#Listar controladores
			# Agrupar controladores por tipo, de acuerdo a lo que hay en AYUDA
			/usr/local/opendomo/vr/espeak.sh Menu11e
			echo "menu11" > /usr/local/opendomo/vr/MENU
			;; 
			2)
			#Cambiar estado
			#Preguntar estado  y acabar
			/usr/local/opendomo/vr/espeak.sh Menu12e
			echo "menu12" > /usr/local/opendomo/vr/MENU
			;; 
			10)
			#10 ==> Volver
			/usr/local/opendomo/vr/espeak.sh Menu0
			echo "menu0" > /usr/local/opendomo/vr/MENU
			;;
			else)
			#Opción no válida. Repetir opciones de menu, y quedarse en el mismo estado
			/usr/local/opendomo/vr/espeak.sh Menunoval Menu1e
			;;   

		esac
		;;
	menu11)
		case "$1" in
			1)
			#Luces
			# 
			$ESPEAK < /etc/opendomo/speech/lightmenu.txt
			echo "menu111" > /usr/local/opendomo/vr/MENU
			;; 
			2)
			#Clima
			# 
			$ESPEAK < /etc/opendomo/speech/climamenu.txt
			echo "menu112" > /usr/local/opendomo/vr/MENU
			;; 
			3)
			#Musica
			# 
			$ESPEAK < /etc/opendomo/speech/musicmenu.txt
			echo "menu113" > /usr/local/opendomo/vr/MENU
			;; 
			4)
			#VideoVigilancia
			# 
			$ESPEAK < /etc/opendomo/speech/videomenu.txt
			echo "menu114" > /usr/local/opendomo/vr/MENU
			;; 
			5)
			#Sensores
			# 
			$ESPEAK < /etc/opendomo/speech/sensorsmenu.txt
			echo "menu115" > /usr/local/opendomo/vr/MENU
			;; 
			6)
			#Termostatos
			# 
			$ESPEAK < /etc/opendomo/speech/varclimatemenu.txt
			echo "menu116" > /usr/local/opendomo/vr/MENU
			;; 
			7)
			#Reguladores de Luz
			# 
			$ESPEAK < /etc/opendomo/speech/varlightmenu.txt
			echo "menu117" > /usr/local/opendomo/vr/MENU
			;; 
			10)
			#10 ==> Volver
			/usr/local/opendomo/vr/espeak.sh Menu1e
			echo "menu1" > /usr/local/opendomo/vr/MENU
			;;
			else)
			#Opción no válida. Repetir opciones de menu, y quedarse en el mismo estado
			/usr/local/opendomo/vr/espeak.sh Menunoval Menu11e
			;;   

		esac
		;;
	menu12)
		case "$1" in
			1)
			#Pasar a modo activo
			#
			/usr/local/opendomo/setSystemState.sh activ
			/usr/local/opendomo/vr/espeak.sh Menucambestactiv
			;; 
			2)
			#Pasar a modo vigilancia
			#
			/usr/local/opendomo/setSystemState.sh secured
			/usr/local/opendomo/vr/espeak.sh Menucambestvig
			;; 
			3)
			#Pasar a modo desactivado
			#Volver luego al menu anterior
			/usr/local/opendomo/setSystemState.sh sleeping
			/usr/local/opendomo/vr/espeak.sh Menucambestdesac
			;; 
			10)
			#10 ==> Volver
			/usr/local/opendomo/vr/espeak.sh Menu1e
			echo "menu1" > /usr/local/opendomo/vr/MENU
			;;
			else)
			#Opción no válida. Repetir opciones de menu, y quedarse en el mismo estado
			/usr/local/opendomo/vr/espeak.sh Menunoval Menu12
			;;   

		esac
		;;
	menu111)
		if [ "$1" = "10" ]
		then
			# This option, restarts MENU, to the first level	
			/usr/local/opendomo/vr/espeak.sh Menu11e
			echo "menu11" > /usr/local/opendomo/vr/MENU
		else
			#Fields <activar/desactivar> nrzone  
			par1=`echo $1 |cut -d " " -f1 -`
			par2=`echo $1 |cut -d " " -f2 -`	 
			zona=`grep $par2 /etc/opendomo/speech/lightmenu.txt |  cut -d " " -f1 -`
			if [ "$par1" = "activar" ]
			then
				/usr/local/opendomo/vr/Recognition/bin/LucesON $zona
			elif [ "$par2" = "desactivar" ]
			then
				/usr/local/opendomo/vr/Recognition/bin/LucesOFF $zona
			else
				/usr/local/opendomo/vr/espeak.sh MenuONOFF
			fi		
		
		fi
		;;
	menu112)
		if [ "$1" = "10" ]
		then
			# This option, restarts MENU, to the first level	
			/usr/local/opendomo/vr/espeak.sh Menu11e
			echo "menu11" > /usr/local/opendomo/vr/MENU
		else
			#Fields <activar/desactivar> nrzone  
			par1=`echo $1 |cut -d " " -f1 -`
			par2=`echo $1 |cut -d " " -f2 -`	 
			zona=`grep $par2 /etc/opendomo/speech/climamenu.txt |  cut -d " " -f1 -`
			if [ "$par1" = "activar" ]
			then
				/usr/local/opendomo/vr/Recognition/bin/ClimaON $zona
			elif [ "$par1" = "deactivar" ]
			then
				/usr/local/opendomo/vr/Recognition/bin/ClimaOFF $zona
			else
				/usr/local/opendomo/vr/espeak.sh MenuONOFF
			fi
		fi		
		;;
	menu113)
		if [ "$1" = "10" ]
		then
			# This option, restarts MENU, to the first level	
			/usr/local/opendomo/vr/espeak.sh Menu11e
			echo "menu11" > /usr/local/opendomo/vr/MENU
		else		
			#Fields <activar/desactivar> nrzone  
			par1=`echo $1 |cut -d " " -f1 -`
			par2=`echo $1 |cut -d " " -f2 -`	 
			zona=`grep $par2 /etc/opendomo/speech/musicmenu.txt |  cut -d " " -f1 -`		
		
			if [ "$par1" = "activar" ]
			then
				/usr/local/opendomo/vr/Recognition/bin/MusicON $zona
			elif [ "$par1" = "desactivar" ]
			then
				/usr/local/opendomo/vr/Recognition/bin/MusicOFF $zona
			else
				/usr/local/opendomo/vr/espeak.sh MenuONOFF
			fi	
		fi	
		;;
	menu114)
				if [ "$1" = "10" ]
		then
			# This option, restarts MENU, to the first level	
			/usr/local/opendomo/vr/espeak.sh Menu11e
			echo "menu11" > /usr/local/opendomo/vr/MENU
		else
			#Fields <activar/desactivar> nrzone   
			par1=`echo $1 |cut -d " " -f1 -`
			par2=`echo $1 |cut -d " " -f2 -`	 
			zona=`grep $par2 /etc/opendomo/speech/videomenu.txt |  cut -d " " -f1 -`		 
		
			if [ "$par1" = "activar" ]
			then
				/usr/local/opendomo/vr/Recognition/bin/VideoON $zona
			elif [ "$par1" = "desactivar" ]
			then
				/usr/local/opendomo/vr/Recognition/bin/VideoOFF $zona
			else
				/usr/local/opendomo/vr/espeak.sh MenuONOFF
			fi
		fi		
		;;
	menu115)
		if [ "$1" = "10" ]
		then
			# This option, restarts MENU, to the first level	
			/usr/local/opendomo/vr/espeak.sh Menu11e
			echo "menu11" > /usr/local/opendomo/vr/MENU
		else
			#Field nrsensor
			 zona=`grep $1 /etc/opendomo/speech/sensorsmenu.txt |  cut -d " " -f1 -`
			/usr/local/opendomo/vr/Recognition/bin/Sensors $zona
		fi
		;;
	menu116)
		if [ "$1" = "10" ]
		then
			# This option, restarts MENU, to the first level	
			/usr/local/opendomo/vr/espeak.sh Menu11e
			echo "menu11" > /usr/local/opendomo/vr/MENU
		else
			#Fields "value" nrzone value(ºC)  
			par1=`echo $1 |cut -d " " -f2 -`
			par2=`echo $1 |cut -d " " -f3 -`	 
			zona=`grep $par1 /etc/opendomo/speech/varclimatemenu.txt |  cut -d " " -f1 -`
			#VarClimate has 1 parameter with both parameters, separated by one space
			line=$zona" "$par2
			/usr/local/opendomo/vr/Recognition/bin/VarClimate $line
		fi
		;;
	menu117)
		if [ "$1" = "10" ]
		then
			# This option, restarts MENU, to the first level	
			/usr/local/opendomo/vr/espeak.sh Menu11e
			echo "menu11" > /usr/local/opendomo/vr/MENU
		else
			#Fields "value" nrzone value(%)  
			par1=`echo $1 |cut -d " " -f2 -`
			par2=`echo $1 |cut -d " " -f3 -`	 
			zona=`grep $par1 /etc/opendomo/speech/varlightmenu.txt |  cut -d " " -f1 -`
			#VarClimate has 1 parameter with both parameters, separated by one space
			line=$zona" "$par2
			/usr/local/opendomo/vr/Recognition/bin/VarLight $line
		fi
		;;	 		 			 			 			 			 		 	
	esac
fi

